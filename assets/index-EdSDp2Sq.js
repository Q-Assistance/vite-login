import{initializeApp as g}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import{getAuth as p,GoogleAuthProvider as l,onAuthStateChanged as m,createUserWithEmailAndPassword as f,signInWithEmailAndPassword as y,signInWithPopup as h,signOut as w}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const b={apiKey:"AIzaSyDWLKNcoGJN0jYVTw4RAOPhSsp76zTYFJg",authDomain:"message-app-9588a.firebaseapp.com",projectId:"message-app-9588a",storageBucket:"message-app-9588a.firebasestorage.app",messagingSenderId:"144799957830",appId:"1:144799957830:web:d0f8b972d34f7d2bae5b47"},I=g(b),s=p(I),v=new l,c=document.getElementById("logged-in-view"),d=document.getElementById("logged-out-view"),u=document.getElementById("user-email"),E=document.getElementById("signin-email-input"),k=document.getElementById("signin-password-input"),B=document.getElementById("signup-email-input"),P=document.getElementById("signup-password-input"),S=document.getElementById("sign-in-with-google-btn"),A=document.getElementById("sign-up-with-google-btn"),L=document.getElementById("sign-up-btn"),D=document.getElementById("sign-in-btn"),O=document.getElementById("logout-button");m(s,t=>{t?(u.innerText=t.email??"",c.style.display="block",d.style.display="none"):(u.innerText="",c.style.display="none",d.style.display="block")});L?.addEventListener("click",async t=>{t&&typeof t.preventDefault=="function"&&t.preventDefault();const e=(B?.value??"").trim(),n=P?.value??"";if(console.log("Create Account Button Clicked"),console.log(`Email: ${e}`),!e||!n){alert("Please provide both email and password.");return}try{const{user:r}=await f(s,e,n);console.log("Signed up:",r.uid),alert("Account created successfully.")}catch(r){switch(console.error("Sign-up error:",r.code,r.message),r.code){case"auth/email-already-in-use":alert("This email is already registered. Try signing in or reset your password.");break;case"auth/invalid-email":alert("Invalid email format.");break;case"auth/weak-password":alert("Password is too weak. Try a stronger one (e.g., 8+ chars, mix of letters, numbers, symbols).");break;case"auth/admin-restricted-operation":alert("Sign-up restricted. Ensure Email/Password is enabled and domain is authorized.");break;default:alert("Unable to create account. Please try again.")}}});D?.addEventListener("click",async t=>{t&&typeof t.preventDefault=="function"&&t.preventDefault();const e=(E?.value??"").trim(),n=k?.value??"";if(console.log("Login Clicked"),console.log(`Email: ${e}`),!e||!n){alert("Please provide both email and password.");return}try{const{user:r}=await y(s,e,n);console.log("Signed in:",r.uid)}catch(r){switch(console.error("Sign-in error:",r.code,r.message),r.code){case"auth/invalid-email":alert("Invalid email format.");break;case"auth/user-not-found":alert("No account found with this email.");break;case"auth/wrong-password":alert("Incorrect password.");break;case"auth/network-request-failed":alert("Network error. Check your connection.");break;default:alert("Unable to sign in. Please try again.")}}});[S,A].forEach(t=>{t?.addEventListener("click",async e=>{e&&typeof e.preventDefault=="function"&&e.preventDefault(),console.log("Google Signin Clicked");try{const n=await h(s,v),o=l.credentialFromResult(n)?.accessToken,a=n.user;console.log("Google user:",a.uid,a.email,o?"token present":"no token")}catch(n){console.error("Google sign-in error:",n.code,n.message),n?.customData?.email,l.credentialFromError(n),alert("Google sign-in failed. Please try again.")}})});O?.addEventListener("click",async t=>{t&&typeof t.preventDefault=="function"&&t.preventDefault(),console.log("Logout Clicked");try{await w(s),console.log("Signed out successfully")}catch(e){console.error("Sign-out error:",e.code,e.message),alert("Unable to sign out. Please try again.")}});
